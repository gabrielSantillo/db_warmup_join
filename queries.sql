insert into guest (name, created_at, phone_number)
values ('Gabriel', '2022-09-17', '15878880999'),
('Natalia', '2022-09-17', '15878880977'),
('Daniel', '2022-09-17', '15878880966'),
('Jose', '2022-09-17', '15878880944'),
('Damaris', '2022-09-17', '15878880971'),
('Angelina', '2022-09-17', '15878880952'),
('Chicago', '2022-09-17', '15878880912'),
('Ira', '2022-09-17', '15878880944'),
('Nascimento', '2022-09-17', '15878880978'),
('Pipoca', '2022-09-17', '15878880900');

insert into room (room_number, square_feet)
values (10, 25), (11, 25), (12, 25), (13, 25), (14, 25), (15, 25), (16, 25), (17, 25), (18, 25), (19, 25),
(20, 25), (21, 25), (22, 25), (23, 25), (24, 25), (25, 25), (26, 25), (27, 25), (28, 25), (29, 25);

insert into current_guest_room (guest_id, room_id, check_in_date, check_out_date)
values (1, 1, '2022-09-17', '2022-09-20'), (2, 1, '2022-09-17', '2022-09-20'), (3, 2, '2022-09-17', '2022-09-20'),
(4, 2, '2022-09-17', '2022-09-20'), (5, 2, '2022-09-17', '2022-09-20');

insert into historical_guest_room (guest_id, room_id, check_in_date, check_out_date)
values (1, 1, '2022-09-17', '2022-09-20'), (2, 1, '2022-09-17', '2022-09-20'), (3, 2, '2022-09-17', '2022-09-20'),
(4, 2, '2022-09-17', '2022-09-20'), (5, 2, '2022-09-17', '2022-09-20'), (6, 1, '2022-09-17', '2022-09-20'), (7, 1, '2022-09-17', '2022-09-20'), (8, 2, '2022-09-17', '2022-09-20'),
(9, 2, '2022-09-17', '2022-09-20'), (10, 2, '2022-09-17', '2022-09-20'), (1, 1, '2022-09-17', '2022-09-20'), (2, 1, '2022-09-17', '2022-09-20'), (3, 2, '2022-09-17', '2022-09-20'),
(4, 2, '2022-09-17', '2022-09-20'), (5, 2, '2022-09-17', '2022-09-20'), (1, 1, '2022-09-17', '2022-09-20'), (2, 1, '2022-09-17', '2022-09-20'), (3, 2, '2022-09-17', '2022-09-20'),
(4, 2, '2022-09-17', '2022-09-20'), (5, 2, '2022-09-17', '2022-09-20'),(1, 1, '2022-09-17', '2022-09-20'), (2, 1, '2022-09-17', '2022-09-20'), (3, 2, '2022-09-17', '2022-09-20'),
(4, 2, '2022-09-17', '2022-09-20'), (5, 2, '2022-09-17', '2022-09-20'),(1, 1, '2022-09-17', '2022-09-20'), (2, 1, '2022-09-17', '2022-09-20'), (3, 2, '2022-09-17', '2022-09-20'),
(4, 2, '2022-09-17', '2022-09-20'), (5, 2, '2022-09-17', '2022-09-20');

select g.name, g.phone_number, r.room_number
from current_guest_room cgr  
inner join room r on cgr.room_id = r.id
inner join guest g on cgr.guest_id = g.id;

select g.name, g.phone_number, r.room_number
from historical_guest_room hgr 
inner join guest g on hgr.guest_id = g.id 
inner join room r on hgr.room_id = r.id
where hgr.check_out_date < '2022-01-01';


